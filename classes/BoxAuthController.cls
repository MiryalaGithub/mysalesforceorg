public class BoxAuthController {
    public string body{set;get;}
    public PageReference authenticate(){
        return new PageReference('https://account.box.com/api/oauth2/authorize?client_id=cotdih7auf8hu21smeol5bqr0jrhiyq5&response_type=code&');
        
    }
    
    public void getAccessToken(){
        String authcode = apexpages.currentPage().getParameters().get('code');   
        system.debug('AuthCOde:'+authcode);
        Http http = new Http();
        HttpRequest request = new HttpRequest();
        request.setEndpoint('https://api.box.com/oauth2/token');
        request.setMethod('POST');
        request.setHeader('Accept', 'Application/json');
        request.setBody('grant_type=authorization_code&code='+authcode+'&client_id=cotdih7auf8hu21smeol5bqr0jrhiyq5&client_secret=h3RX9san4Si898sDdAz8RVQnhAZX2Wbj');
        HttpResponse response = http.send(request);
        body = response.getBody();
        fromJSON d = (fromJSON)JSON.deserialize(response.getBody(), fromJSON.class);
        body= getFolders(d.access_token);
        parseFolderContent p = (parseFolderContent)JSON.deserialize(body, parseFolderContent.class);
    }
    public String getFolders(String access_token){
        Http http= new Http();
        HttpRequest req= new HttpRequest();
        req.setEndpoint('https://api.box.com/2.0/folders/175022440916/items');
        req.setMethod('GET');
        req.setHeader('Accept','application/json');
         req.setHeader('Authorization', 'Bearer '+access_token);
        HttpResponse res = http.send(req);
        return res.getBody();
    }
    //
//Generated by AdminBooster
//

public class fromJSON{
	public String access_token;	//YljcKz3HIMcnSdmdK30NYUchgqI3XuOO
	public Integer expires_in;	//3956
	public cls_restricted_to[] restricted_to;
	public String refresh_token;	//GdRRLOFcTKcSaGLfkxktOW87BfjQ8UTiRM1G9Iax5KZ6WtPHOgSAiBMlgt3YYLl0
	public String token_type;	//bearer	
}
    class cls_restricted_to {
	}
    //
//Generated by AdminBooster
//

public class parseFolderContent{
	public Integer total_count;	//1
	public cls_entries[] entries;
	public Integer offset;	//0
	public Integer limit_x;	//100
	public cls_order[] order;
}
    class cls_entries {
		public String type;	//file
		public String id;	//1027025918810
		public cls_file_version file_version;
		public String sequence_id;	//1
		public String etag;	//1
		public String sha1;	//a6ad210227a0b9fb2a0ee8949fe4caaaab0d9c32
		public String name;	//CPQ BASICS.docx
	}
	class cls_file_version {
		public String type;	//file_version
		public String id;	//1112719865210
		public String sha1;	//a6ad210227a0b9fb2a0ee8949fe4caaaab0d9c32
	}
	class cls_order {
		public String by_x;	//type
		public String direction;	//ASC
	}
	

	
}